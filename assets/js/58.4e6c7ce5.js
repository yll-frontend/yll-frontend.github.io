(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{382:function(a,t,e){"use strict";e.r(t);var s=e(4),r=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"jwt浅析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt浅析"}},[a._v("#")]),a._v(" JWT浅析")]),a._v(" "),t("h2",{attrs:{id:"什么是jwt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是jwt"}},[a._v("#")]),a._v(" 什么是JWT")]),a._v(" "),t("p",[a._v("Json web token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。")]),a._v(" "),t("h2",{attrs:{id:"jwt的构成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt的构成"}},[a._v("#")]),a._v(" JWT的构成")]),a._v(" "),t("p",[a._v("JWT由头部（header）, 荷载（payload）,签名（signature）三部分组成，就像这样:")]),a._v(" "),t("p",[a._v("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ")]),a._v(" "),t("h3",{attrs:{id:"header"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#header"}},[a._v("#")]),a._v(" header")]),a._v(" "),t("p",[a._v("jwt的头部有许多可选属性比如typ（描述 JWT 的媒体类型），kid（用于提示是哪个密钥参与加密），alg（指定加密算法，常直接使用 HMAC SHA256），其中只有alg是必须指定的")]),a._v(" "),t("p",[a._v("一般完整的头部就像下面这样的JSON：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("{  'typ': 'JWT',  'alg': 'HS256' }\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("然后将头部进行base64加密就可以得到JWT第一部分header的内容")]),a._v(" "),t("p",[a._v("eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9")]),a._v(" "),t("h3",{attrs:{id:"playload"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#playload"}},[a._v("#")]),a._v(" playload")]),a._v(" "),t("p",[a._v("载荷用于存放需要用JWT承载的内容，这部分内容默认是不加密的，只经过base64处理，一般不放敏感信息")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('{   "sub": "1234567890",  "name": "John Doe", } \n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("经过base64处理后，得到JWT的第二部分。")]),a._v(" "),t("p",[a._v("eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9")]),a._v(" "),t("h3",{attrs:{id:"signature"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#signature"}},[a._v("#")]),a._v(" signature")]),a._v(" "),t("p",[a._v("jwt的第三部分是一个签证信息，这个签证信息由三部分组成，组成公式如下所示：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('HMACSHA256(  base64UrlEncode(header) + "." +  base64UrlEncode(payload),  secret)\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("这个部分需要将base64加密后的header和base64加密后的payload使用.连接组成的字符串，然后通过header中声明的加密方式（例如：HMACSHA256）和自己设置的secret密钥进行加密。成为jwt的第三部分。")]),a._v(" "),t("p",[a._v("TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ")]),a._v(" "),t("p",[a._v("将这三部分用.连接成一个完整的字符串,构成了最终的jwt:")]),a._v(" "),t("p",[a._v("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ")]),a._v(" "),t("p",[a._v("注意："),t("strong",[a._v("secret")]),a._v("是保存在服务器端的，"),t("strong",[a._v("jwt")]),a._v("的签发生成也是在服务器端的，"),t("strong",[a._v("secret")]),a._v("就是用来进行"),t("strong",[a._v("jwt")]),a._v("的签发和"),t("strong",[a._v("jwt")]),a._v("的验证，所以，它就是你服务端的私钥，在任何场景都不应该流露出去。一旦客户端得知这个"),t("strong",[a._v("secret,")]),a._v(" 那就意味着客户端是可以自我签发"),t("strong",[a._v("jwt")]),a._v("了。")]),a._v(" "),t("h2",{attrs:{id:"jwt使用流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt使用流程"}},[a._v("#")]),a._v(" JWT使用流程")]),a._v(" "),t("ul",[t("li",[a._v("用户使用用户名密码来请求服务器")]),a._v(" "),t("li",[a._v("服务器进行验证用户的信息，返回JWT token")]),a._v(" "),t("li",[a._v("客户端存储token，并在每次请求时（一般在header中的Authorization字段）中带上这个JWT token")]),a._v(" "),t("li",[a._v("服务端验证token值，并返回数据")])]),a._v(" "),t("h2",{attrs:{id:"jwt的优点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt的优点"}},[a._v("#")]),a._v(" JWT的优点")]),a._v(" "),t("ul",[t("li",[a._v("因为json的通用性，所以JWT是可以进行跨语言支持的，像JAVA,JavaScript,NodeJS,PHP等很多语言都可以使用。")]),a._v(" "),t("li",[a._v("因为有了payload部分，所以JWT可以在自身存储一些其他业务逻辑所必要的非敏感信息。")]),a._v(" "),t("li",[a._v("便于传输，jwt的构成非常简单，字节占用很小，所以它是非常便于传输的。")]),a._v(" "),t("li",[a._v("它不需要在服务端保存会话信息, 所以它易于应用的扩展")])]),a._v(" "),t("p",[a._v("若是对jwt生成的过程有兴趣可以自己去https://jwt.io/ 去尝试一下生成JWT Token")])])}),[],!1,null,null,null);t.default=r.exports}}]);