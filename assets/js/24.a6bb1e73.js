(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{348:function(e,t,s){"use strict";s.r(t);var r=s(4),a=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"构建警告-broswerslist-caniuse-lite-is-outdated"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建警告-broswerslist-caniuse-lite-is-outdated"}},[e._v("#")]),e._v(" 构建警告:BroswersList: caniuse-lite is outdated")]),e._v(" "),t("h2",{attrs:{id:"现象如下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#现象如下"}},[e._v("#")]),e._v(" 现象如下")]),e._v(" "),t("p",[t("img",{attrs:{src:"/Users/lilinyang/Desktop/%E6%88%AA%E5%9B%BE/md/broswerList%E5%91%8A%E8%AD%A6%E4%BF%A1%E6%81%AF.assets/image-20211012114043932.png",alt:"image-20211012114043932"}})]),e._v(" "),t("p",[e._v("从警告信息可以看出，是"),t("code",[e._v("BroswerList")]),e._v("抛出的。")]),e._v(" "),t("h2",{attrs:{id:"broswerslist是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#broswerslist是什么"}},[e._v("#")]),e._v(" "),t("code",[e._v("BroswersList")]),e._v("是什么？")]),e._v(" "),t("p",[t("em",[e._v("Browserslist 是一个前端项目配置工具，功能是在前端工具之间共享目标环境的浏览器信息。")])]),e._v(" "),t("p",[e._v("现代前端项目中，我们会使用 "),t("code",[e._v("Babel")]),e._v(" 来转换"),t("code",[e._v("ES6")]),e._v(" 语法、使用 "),t("code",[e._v("AutoPrefixer")]),e._v(", "),t("code",[e._v("PostCSS")]),e._v("来转换 "),t("code",[e._v("CSSNext")]),e._v(" 语法、使用"),t("code",[e._v("ESLint")]),e._v(" 来保证代码质量和规范。所以一般在前端项目中会使用下面常用的工具：")]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fpostcss%2Fautoprefixer",target:"_blank",rel:"noopener noreferrer"}},[e._v("Autoprefixer"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fbabel%2Fbabel%2Ftree%2Fmaster%2Fpackages%2Fbabel-preset-env",target:"_blank",rel:"noopener noreferrer"}},[e._v("Babel"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fjonathantneal%2Fpostcss-preset-env",target:"_blank",rel:"noopener noreferrer"}},[e._v("post-preset-env"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Familajack%2Feslint-plugin-compat",target:"_blank",rel:"noopener noreferrer"}},[e._v("eslint-plugin-compat"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fismay%2Fstylelint-no-unsupported-browser-features",target:"_blank",rel:"noopener noreferrer"}},[e._v("stylelint-unsupported-browser-features"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fjonathantneal%2Fpostcss-normalize",target:"_blank",rel:"noopener noreferrer"}},[e._v("postcss-normalize"),t("OutboundLink")],1)]),e._v(" "),t("p",[e._v("这些工具会根据"),t("code",[e._v("BroswersList")]),e._v("配置的目标浏览器环境来决定使用那些策略来处理我们的源代码。")])])]),e._v(" "),t("p",[e._v("配置方法：")]),e._v(" "),t("ul",[t("li",[t("strong",[e._v("在项目中添加一个"),t("code",[e._v(".browserlistrc")]),e._v("文件")]),e._v("(我们的项目使用的方式)")]),e._v(" "),t("li",[e._v("通过配置"),t("code",[e._v("package.json")]),e._v(" 文件")])]),e._v(" "),t("p",[t("code",[e._v("BroswersList")]),e._v("能够把"),t("a",{attrs:{href:"http://git.in-hope.cn/root/xiaoan-web/-/blob/release/.browserslistrc",target:"_blank",rel:"noopener noreferrer"}},[e._v(".browserslistrc"),t("OutboundLink")],1),e._v("文件转换成一组浏览器集合。"),t("code",[e._v("BroswersList")]),e._v("的主要职责就是转换上述文件的配置内容，按照正则过滤出正确浏览器列表内容，而它本身不提供浏览器数据的来源。")]),e._v(" "),t("p",[t("code",[e._v("Browserslist")]),e._v("的浏览器数据来源就是"),t("code",[e._v("caniuse-lite")]),e._v("，而"),t("code",[e._v("caniuse-lite")]),e._v("是"),t("code",[e._v("caniuse-db")]),e._v("库的精简版本，"),t("code",[e._v("caniuse-lite")]),e._v("是对"),t("code",[e._v("caniuse-db")]),e._v("数据按照一定规则做了简化，减小了代码体积，暴露了一些"),t("code",[e._v("api")]),e._v("供他人使用，每当"),t("code",[e._v("caniuse-db")]),e._v("更新时，"),t("code",[e._v("caniuse-lite")]),e._v("也会跟着一起发布版本。")]),e._v(" "),t("blockquote",[t("p",[e._v("在"),t("code",[e._v("vue-cli")]),e._v("中，"),t("code",[e._v("Browserslist")]),e._v("字段会被 "),t("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fnew.babeljs.io%2Fdocs%2Fen%2Fnext%2Fbabel-preset-env.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("@babel/preset-env"),t("OutboundLink")],1),e._v(" 和 "),t("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fpostcss%2Fautoprefixer",target:"_blank",rel:"noopener noreferrer"}},[e._v("Autoprefixer"),t("OutboundLink")],1),e._v(" 用来确定需要转译的 "),t("code",[e._v("JavaScript")]),e._v("特性和需要添加的 CSS 浏览器前缀。")])]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fbrowserslist",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm地址"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://links.jianshu.com/go?to=%5Bhttps%3A%2F%2Fgithub.com%2Fbrowserslist%2Fbrowserslist%5D(https%3A%2F%2Fgithub.com%2Fbrowserslist%2Fbrowserslist)",target:"_blank",rel:"noopener noreferrer"}},[e._v("github"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"原因"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#原因"}},[e._v("#")]),e._v(" 原因")]),e._v(" "),t("p",[e._v("根本原因是由于"),t("code",[e._v("caniuse-lite")]),e._v("的版本过低。")]),e._v(" "),t("p",[t("code",[e._v("vue")]),e._v("构建时发现已安装的"),t("code",[e._v("caniuse-lite")]),e._v("版本比当前版本早2个版本，则会在"),t("strong",[e._v("构建/启动")]),e._v("过程中由浏览器列表中的脚本输出此警告消息:")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("caniuse-lite is outdated.Please run:\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("解决问题的建议"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("如果项目中的任何内容都没有更改，并且在启动或构建项目时突然看到此消息，"),t("strong",[e._v("则可能意味着"),t("code",[e._v("caniuse-lite")]),e._v("有最新版本的更新")]),e._v("。当我们运行"),t("code",[e._v("BroswersList")]),e._v("的建议时，会发现没有任何作用，这是由于"),t("code",[e._v("caniuse-lite")]),e._v("并不是我们项目的依赖，我们的"),t("code",[e._v("package.json")]),e._v("文件中没有注册"),t("code",[e._v("caniuse-lite")]),e._v("，因此当我们运行"),t("code",[e._v("npx")])]),e._v(" "),t("p",[e._v("这些包如何成为依赖项？在通过vue-cli创建项目时，npm安装的browserslist是其所需工具的依赖项(例如："),t("code",[e._v("babel")]),e._v(")，而不是项目的依赖项之一。同时，"),t("code",[e._v("caniuse-lite")]),e._v("被安装为浏览器列表的依赖项。")]),e._v(" "),t("h2",{attrs:{id:"解决方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决方式"}},[e._v("#")]),e._v(" 解决方式")]),e._v(" "),t("p",[e._v("升级"),t("code",[e._v("caniuse-lite")]),e._v("的版本，有以下几种方式：")]),e._v(" "),t("ul",[t("li",[t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" update  caniuse-lite @last\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("这种方式会给我们的项目中增加"),t("code",[e._v("package.lock.json")]),e._v("文件，由于我们项目中推荐使用"),t("code",[e._v("yarn")]),e._v("命令，并且项目中已经存在"),t("code",[e._v("yarn.lock")]),e._v("文件，会增加额外文件，并且与规范不符。")])]),e._v(" "),t("li",[t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--depth")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("20")]),e._v(" update "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--save")]),e._v(" caniuse-lite browserslist  \n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("blockquote",[t("p",[e._v("这条命令比较特殊，执行这条命令后，"),t("code",[e._v("npm")]),e._v("将会递归的检查更新"),t("code",[e._v("caniuse-lite browserslist")]),e._v("所有的依赖项。")]),e._v(" "),t("p",[e._v("从"),t("code",[e._v("npm@2.6.1")]),e._v("，"),t("code",[e._v("npm update")]),e._v("将只检查顶级包（即项目本身"),t("code",[e._v("package.json")]),e._v("文件中声明的依赖）。"),t("code",[e._v("npm")]),e._v("的旧版本会递归检查所有依赖项。要获得旧行为，请使用"),t("code",[e._v("npm --depth 9999 update")]),e._v(".")]),e._v(" "),t("p",[e._v("从 "),t("code",[e._v("npm@5.0.0")]),e._v("开始，"),t("code",[e._v("npm update")]),e._v("将更"),t("code",[e._v("package.json")]),e._v("改为将新版本保存为所需的最低依赖项。要获得旧行为，请使用"),t("code",[e._v("npm update --no-save")]),e._v(".")])]),e._v(" "),t("p",[e._v("这种方式会递归更新所有依赖"),t("code",[e._v("caniuse-lite")]),e._v(" "),t("code",[e._v("browserslist")]),e._v("的文件，同时也会更新"),t("code",[e._v("yarn.lock")]),e._v("文件的格式，并且该命令是"),t("code",[e._v("npm")]),e._v("较早版本的命令，从另一个角度说明了这种更新依赖的方式是不可取的")])]),e._v(" "),t("li",[t("p",[e._v("删除"),t("code",[e._v("yarn.lock")]),e._v("文件，重新运行"),t("code",[e._v("yarn")]),e._v("安装项目的依赖")]),e._v(" "),t("p",[e._v("没有任何副作用，符合规范")])])]),e._v(" "),t("p",[e._v("​                                                 "),t("em",[e._v("参考：")])]),e._v(" "),t("p",[e._v("​                                                 "),t("em",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/59270927",target:"_blank",rel:"noopener noreferrer"}},[e._v("认识caniuse-lite"),t("OutboundLink")],1)])]),e._v(" "),t("p",[e._v("​                                                 "),t("em",[t("a",{attrs:{href:"https://www.npmjs.cn/cli/update/",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm update详解"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=a.exports}}]);